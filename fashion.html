<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>AI Fit Check | Rate My Drip</title>
<style>
  body { font-family: Arial, sans-serif; background:#f0f0f5; text-align:center; margin:0; padding:0; }
  .container { max-width:800px; margin:50px auto; background:white; padding:20px; border-radius:15px; box-shadow:0 0 20px rgba(0,0,0,0.1);}
  h1 { margin-bottom:10px; }
  .upload-zone { margin:20px 0; }
  input[type=file] { display:none; }
  label.btn-primary { background:#0070f3; color:white; padding:10px 20px; border-radius:10px; cursor:pointer; }
  .preview-box img { max-width:100%; margin:10px 0; border-radius:10px; border:2px solid #ccc; }
  .results { display:flex; flex-wrap:wrap; justify-content:center; gap:20px; margin-top:20px; }
  .fit-box { border:2px solid #ccc; padding:10px; border-radius:10px; width:300px; background:#fafafa; }
  button { padding:8px 16px; border:none; border-radius:8px; background:#555; color:white; cursor:pointer; margin-top:10px;}
</style>
</head>
<body>
<div class="container">
  <h1>AI Fit Check | Gen Z Mode</h1>
  <p id="status">Upload one or two fits for a vibe check.</p>

  <div class="upload-zone">
    <input type="file" id="fashionUpload1" accept="image/*">
    <label for="fashionUpload1" class="btn-primary">Upload First Fit</label>
  </div>

  <div class="upload-zone">
    <input type="file" id="fashionUpload2" accept="image/*">
    <label for="fashionUpload2" class="btn-primary">Upload Second Fit (Optional)</label>
  </div>

  <div class="results" id="fashionResults"></div>
</div>

<script>
const BACKEND_URL = "https://looksly.vercel.app/api/analyze"; // replace with your API
const status = document.getElementById("status");
const fashionResults = document.getElementById("fashionResults");

async function analyzeFile(file) {
  const formData = new FormData();
  formData.append("file", file);

  const res = await fetch(BACKEND_URL, { method: "POST", body: formData });
  const data = await res.json();
  return data;
}

function createFitBox(data, imgSrc, label) {
  const div = document.createElement("div");
  div.className = "fit-box";
  div.innerHTML = `
    <h3>${label}</h3>
    <img src="${imgSrc}">
    <p><strong>Fit Score:</strong> ${data.fitScore}/10</p>
    <p><strong>Style:</strong> ${data.styleDescription}</p>
    <p><strong>Tags:</strong> ${data.detectedLabels.join(", ") || "basic essentials"}</p>
    <p><strong>Caption:</strong> ${data.caption}</p>
  `;
  return div;
}

async function handleUpload(fileInput, label) {
  const file = fileInput.files[0];
  if (!file) return;
  status.innerText = `Uploading ${label} to AI...`;
  const reader = new FileReader();
  reader.onload = async (event) => {
    const imgSrc = event.target.result;
    status.innerText = `AI analyzing ${label}...`;
    try {
      const data = await analyzeFile(file);
      const box = createFitBox(data, imgSrc, label);
      fashionResults.appendChild(box);
      status.innerText = "Vibe check complete!";
      if (fashionResults.children.length === 2) {
        // Compare two fits
        const score1 = fashionResults.children[0].querySelector("p strong").nextSibling.textContent.match(/\d+/)[0];
        const score2 = fashionResults.children[1].querySelector("p strong").nextSibling.textContent.match(/\d+/)[0];
        const winner = score1 > score2 ? "First fit wins!" : score2 > score1 ? "Second fit wins!" : "Tie!";
        const compareDiv = document.createElement("div");
        compareDiv.className = "fit-box";
        compareDiv.innerHTML = `<h3>Comparison Result:</h3><p>${winner}</p>`;
        fashionResults.appendChild(compareDiv);
      }
    } catch (e) {
      console.error(e);
      status.innerText = `Error analyzing ${label}`;
    }
  };
  reader.readAsDataURL(file);
}

// Event listeners
document.getElementById("fashionUpload1").addEventListener("change", () => handleUpload(document.getElementById("fashionUpload1"), "First Fit"));
document.getElementById("fashionUpload2").addEventListener("change", () => handleUpload(document.getElementById("fashionUpload2"), "Second Fit"));

</script>
</body>
</html>
